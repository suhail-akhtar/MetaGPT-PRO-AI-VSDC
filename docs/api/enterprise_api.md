# MetaGPT Enterprise API Documentation

## Overview

The MetaGPT Enterprise API transforms MetaGPT into a fully controllable "Autonomous Software Development Virtual Company." It provides a robust REST and WebSocket interface to manage teams, execute projects, inspect agent states, and access generated artifacts in real-time.

**Base URL**: `http://localhost:8000/v1`

## Endpoints

### 1. Company Management (`/v1/company`)

Manage the lifecycle of the virtual company and its projects.

#### **Hire Team**
Initialize a new team of agents. By default, this hires a standard software development team (Product Manager, Architect, Engineer, QA, etc.).
- **URL**: `/hire`
- **Method**: `POST`
- **Response**:
  ```json
  {
    "message": "Team has been hired and is ready for work."
  }
  ```

#### **Run Project**
Submit a new user requirement to start the autonomous development process.
- **URL**: `/run`
- **Method**: `POST`
- **Body**:
  ```json
  {
    "requirement": "Create a simple snake game in Python",
    "n_round": 3
  }
  ```
- **Response**:
  ```json
  {
    "message": "Project started successfully.",
    "project": null
  }
  ```

#### **Stop Project**
Gracefully stop the current execution loop.
- **URL**: `/stop`
- **Method**: `POST`
- **Response**:
  ```json
  {
    "message": "Project stopped successfully."
  }
  ```

#### **Get Status**
Retrieve the current status of the company and all its agents.
- **URL**: `/status`
- **Method**: `GET`
- **Response**:
  ```json
  {
    "status": "running", // or "idle", "paused"
    "roles": [
      {
        "name": "Alice",
        "profile": "Product Manager",
        "goal": "Create a PRD...",
        "is_idle": false,
        "current_todo": "Write PRD"
      },
      ...
    ],
    "is_idle": false
  }
  ```

#### **Get History**
Retrieve the global message history of the team.
- **URL**: `/history`
- **Method**: `GET`
- **Response**: List of message objects.

---

### 2. Role Inspection & Control (`/v1/roles`)

Inspect individual agents and interact with them directly.

#### **List Roles**
Get a list of all hired agents.
- **URL**: `/`
- **Method**: `GET`
- **Response**: Dictionary of agent names and their limited info.

#### **Get Role Details**
Get detailed information about a specific agent.
- **URL**: `/{name}`
- **Method**: `GET`
- **Response**: Detailed profile, goal, and constraints.

#### **Get Agent Memory**
Fetch the agent's recent thought process and message history.
- **URL**: `/{name}/memory`
- **Method**: `GET`
- **Response**: List of memory items.

#### **Send Message**
Send a direct message to a specific agent to influence their behavior or provide feedback.
- **URL**: `/{name}/message`
- **Method**: `POST`
- **Body**:
  ```json
  {
    "content": "Alice, please verify the game loop logic again."
  }
  ```

---

### 3. Workspace Access (`/v1/files`)

Access the files and code generated by the agents.

#### **List Files**
Get a tree view of the current workspace.
- **URL**: `/tree`
- **Method**: `GET`
- **Response**:
  ```json
  {
    "path": "",
    "items": [
      {"name": "snake_game.py", "type": "file", "size": 1024},
      {"name": "docs", "type": "directory", "size": 0}
    ]
  }
  ```

#### **Read File Content**
Read the content of a specific file.
- **URL**: `/content?path=snake_game.py`
- **Method**: `GET`
- **Response**:
  ```json
  {
    "path": "snake_game.py",
    "content": "import pygame..."
  }
  ```

---

### 4. Configuration (`/v1/config`)

Manage runtime configuration.

#### **Get Configuration**
View current system configuration.
- **URL**: `/`
- **Method**: `GET`

#### **Update Configuration**
Update configuration keys at runtime.
- **URL**: `/`
- **Method**: `PUT`
- **Body**: Key-value pairs of configuration to update.

---

### 5. Real-Time Streaming (`/v1/stream`)

#### **Log Stream**
WebSocket endpoint to stream logs and agent thoughts in real-time.
- **URL**: `ws://localhost:8000/v1/stream/log`
- **Protocol**: WebSocket
- **Messages**: Plain text logs from the agent execution.

## Usage Example (Python)

```python
import requests

BASE_URL = "http://localhost:8000/v1"

# 1. Hire Team
requests.post(f"{BASE_URL}/company/hire")

# 2. Run Project
payload = {"requirement": "Create a Hello World app"}
requests.post(f"{BASE_URL}/company/run", json=payload)

# 3. Check Status
status = requests.get(f"{BASE_URL}/company/status").json()
print(status)
```
